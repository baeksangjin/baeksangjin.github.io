<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAEK Labs | Kinetic Refined Zone</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;300;400&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body { margin: 0; padding: 0; background-color: #ffffff; overflow: hidden; cursor: crosshair; transition: background-color 0.8s ease; }
        canvas { display: block; }
        #ui-layer { position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%); z-index: 100; }
        .mode-btn {
            background: transparent;
            border: 1px solid #000000;
            padding: 14px 32px;
            border-radius: 0;
            font-family: 'Montserrat', sans-serif;
            font-size: 10px;
            font-weight: 400;
            letter-spacing: 5px;
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1);
            color: #000000;
            outline: none;
            text-transform: uppercase;
            display: inline-block;
            text-align: center;
            min-width: 140px;
        }
        .mode-btn:hover { background: #000000; color: #ffffff; }
        body.dark-mode { background-color: #000000; }
        body.dark-mode .mode-btn { border-color: #ffffff; color: #ffffff; }
        body.dark-mode .mode-btn:hover { background: #ffffff; color: #000000; }
    </style>
</head>
<body id="main-body">

<div id="ui-layer">
    <button class="mode-btn" id="kinetic-btn" onclick="handleModeSwitch()">VOID</button>
</div>

<script>
let particles = [];
const numParticles = 11000;
let isDark = false;
let bgColor = 255;
let pColor = 0;
const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
let interval = null;

function decodeText(targetText) {
    const btn = document.getElementById("kinetic-btn");
    let iteration = 0;
    let stopTimings = targetText.split("").map(() => Math.random() * 15 + 5);
    let maxIteration = Math.max(...stopTimings);

    clearInterval(interval);
    interval = setInterval(() => {
        btn.innerText = targetText
            .split("")
            .map((letter, index) => {
                if(iteration > stopTimings[index]) return targetText[index];
                return letters[Math.floor(Math.random() * 26)];
            })
            .join("");
        
        if(iteration >= maxIteration) {
            clearInterval(interval);
            btn.innerText = targetText;
        }
        iteration += 1;
    }, 40);
}

function handleModeSwitch() {
    isDark = !isDark;
    const body = document.getElementById('main-body');
    const targetText = isDark ? "MANIFEST" : "VOID";
    decodeText(targetText);

    if (isDark) {
        body.classList.add('dark-mode');
        bgColor = 0;
        pColor = 255;
    } else {
        body.classList.remove('dark-mode');
        bgColor = 255;
        pColor = 0;
    }
}

function setup() {
    createCanvas(windowWidth, windowHeight);
    for (let i = 0; i < numParticles; i++) {
        particles.push(new Particle());
    }
}

function draw() {
    background(bgColor);
    for (let p of particles) {
        p.update();
        p.bounce();
        p.interact();
        p.show();
    }
}

class Particle {
    constructor() {
        this.pos = createVector(width / 2, height / 2);
        this.vel = p5.Vector.random2D().mult(random(15, 180));
        this.baseSpeed = random() > 0.9 ? random(1.2, 2.1) : random(0.15, 0.9);
        this.origVel = p5.Vector.random2D().mult(this.baseSpeed);
        let angle = random(TWO_PI);
        let r = random(200);
        this.offset = createVector(r * cos(angle), r * sin(angle));
        let rChance = random(1);
        if (rChance > 0.993) this.r = random(10.8, 16.2);
        else if (rChance > 0.88) this.r = random(5, 9);
        else this.r = random(1.6, 3.7);
        this.isPressed = false;
    }

    update() {
        this.pos.add(this.vel);
        if (!mouseIsPressed && this.vel.mag() > this.baseSpeed) this.vel.mult(0.94);
    }

    interact() {
        let mouse = createVector(mouseX, mouseY);
        if (mouseIsPressed) {
            let target = p5.Vector.add(mouse, this.offset);
            let arrive = p5.Vector.sub(target, this.pos);
            let dist = arrive.mag();
            if (dist < 15) {
                this.vel.mult(0.7);
                this.vel.add(p5.Vector.random2D().mult(0.3));
            } else {
                let speed = map(dist, 0, width, 60, 280);
                arrive.setMag(speed);
                this.vel = p5.Vector.lerp(this.vel, arrive, 0.25);
            }
            this.isPressed = true;
        } else {
            if (this.isPressed) {
                this.vel = p5.Vector.random2D().mult(random(120, 240));
                this.isPressed = false;
            }
            let d = p5.Vector.dist(this.pos, mouse);
            if (d < 112) {
                let flee = p5.Vector.sub(this.pos, mouse);
                flee.setMag(3.5);
                this.vel.add(flee);
            } else {
                this.vel.x = lerp(this.vel.x, this.origVel.x, 0.06);
                this.vel.y = lerp(this.vel.y, this.origVel.y, 0.06);
            }
        }
    }

    bounce() {
        if (this.pos.x <= 0 || this.pos.x >= width) {
            this.vel.x *= -1;
            this.origVel.x *= -1;
            this.pos.x = constrain(this.pos.x, 0, width);
        }
        if (this.pos.y <= 0 || this.pos.y >= height) {
            this.vel.y *= -1;
            this.origVel.y *= -1;
            this.pos.y = constrain(this.pos.y, 0, height);
        }
    }

    show() {
        noStroke();
        fill(pColor);
        ellipse(this.pos.x, this.pos.y, this.r);
    }
}

function windowResized() {
    resizeCanvas(windowWidth, windowHeight);
}
</script>
</body>
</html>
